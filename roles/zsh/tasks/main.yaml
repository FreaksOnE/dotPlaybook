- name: Download zsh 5.0.7 sources
  get_url: url=http://sourceforge.net/projects/zsh/files/zsh/5.0.7/zsh-5.0.7.tar.gz/download dest=~/compressed/zsh-5.0.7.tar.gz sha256sum=43f0a4c179ef79bb8c9153575685f7f45f28a3615c8cf96345f503d5b9e7b919

- name: Extract zsh sources
  unarchive: src=~/compressed/zsh-5.0.7.tar.gz dest=~/software/ creates=~/software/zsh-5.0.7

- name: Install the prerequisites for zsh
  apt: pkg=libncurses5-dev
  sudo: yes

- name: Install zsh
  shell: cd {{ ansible_env["HOME"] }}/software/zsh-5.0.7/ && ./configure --prefix=/usr/local && make && make install creates=/usr/local/bin/zsh
  sudo: yes

- name: Enable installed zsh shell
  shell: grep -q -F "/usr/local/bin/zsh" /etc/shells || printf "/usr/local/bin/zsh" >> /etc/shells
  sudo: yes

- name: Set zsh as the user shell
  user: name=iqbal shell=/usr/local/bin/zsh
  sudo: yes
  
- name: Get antigen
  git: repo=https://github.com/zsh-users/antigen.git depth=1 accept_hostkey=True update=yes dest=~/software/antigen

- name: Copy custom zsh config
  copy: src=.zshrc dest=~/.zshrc backup=yes
  
- name: Checkout autojump
  git: repo=git://github.com/joelthelion/autojump.git dest=~/software/autojump depth=1 accept_hostkey=True update=yes

- name: Install autojump using the installation script
  shell: cd ~/software/autojump && ./install.py -p ~/local_packages creates=/home/iqbal/local_packages/bin/autojump

- name: Checkout dircolors-solarized
  git: repo=https://github.com/seebi/dircolors-solarized dest=~/software/dircolors-solarized depth=1 accept_hostkey=True update=yes

- name: Install python-pip need to install percol
  apt: pkg=python-pip
  sudo: yes

- name: Install percol using pip
  pip: name=percol
  sudo: yes

- name: Create directory for percol config
  command: mkdir ~/.percol.d/ creates=~/.percol.d
  
- name: Copy custom percol config
  copy: src=percol_config.py dest=~/.percol.d/rc.py backup=yes
